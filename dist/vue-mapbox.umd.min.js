!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@babel/runtime/helpers/defineProperty"),require("vue"),require("@babel/runtime/helpers/typeof")):"function"==typeof define&&define.amd?define(["exports","@babel/runtime/helpers/defineProperty","vue","@babel/runtime/helpers/typeof"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["vue-mapbox"]={},e._defineProperty,e.vue,e._typeof)}(this,(function(e,t,r,n){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=o(t),a=o(n);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){i.default(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u={methods:{$_emitEvent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.$emit(e,c({map:this.map,component:this},t))},$_emitMapEvent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.$_emitEvent(e.type,c({mapboxEvent:e},t))}}},l={onResize:{name:"resize",listener:"onResize"},onWebglcontextlost:{name:"webglcontextlost",listener:"onWebglcontextlost"},onWebglcontextrestored:{name:"webglcontextrestored",listener:"onWebglcontextrestored"},onRemove:{name:"remove",listener:"onRemove"},onMovestart:{name:"movestart",listener:"onMovestart"},onLoad:{name:"load",listener:"onLoad"},onContextmenu:{name:"contextmenu",listener:"onContextmenu"},onDblclick:{name:"dblclick",listener:"onDblclick"},onClick:{name:"click",listener:"onClick"},onTouchcancel:{name:"touchcancel",listener:"onTouchcancel"},onTouchmove:{name:"touchmove",listener:"onTouchmove"},onTouchend:{name:"touchend",listener:"onTouchend"},onTouchstart:{name:"touchstart",listener:"onTouchstart"},onDataloading:{name:"dataloading",listener:"onDataloading"},onMousemove:{name:"mousemove",listener:"onMousemove"},onMouseup:{name:"mouseup",listener:"onMouseup"},onMousedown:{name:"mousedown",listener:"onMousedown"},onSourcedataloading:{name:"sourcedataloading",listener:"onSourcedataloading"},onError:{name:"error",listener:"onError"},onData:{name:"data",listener:"onData"},onStyledata:{name:"styledata",listener:"onStyledata"},onSourcedata:{name:"sourcedata",listener:"onSourcedata"},onMouseout:{name:"mouseout",listener:"onMouseout"},onStyledataloading:{name:"styledataloading",listener:"onStyledataloading"},onMoveend:{name:"moveend",listener:"onMoveend"},onMove:{name:"move",listener:"onMove"},onRender:{name:"render",listener:"onRender"},onZoom:{name:"zoom",listener:"onZoom"},onZoomstart:{name:"zoomstart",listener:"onZoomstart"},onZoomend:{name:"zoomend",listener:"onZoomend"},onBoxzoomstart:{name:"boxzoomstart",listener:"onBoxzoomstart"},onBoxzoomcancel:{name:"boxzoomcancel",listener:"onBoxzoomcancel"},onBoxzoomend:{name:"boxzoomend",listener:"onBoxzoomend"},onRotate:{name:"rotate",listener:"onRotate"},onRotatestart:{name:"rotatestart",listener:"onRotatestart"},onRotateend:{name:"rotateend",listener:"onRotateend"},onDragend:{name:"dragend",listener:"onDragend"},onDrag:{name:"drag",listener:"onDrag"},onDragstart:{name:"dragstart",listener:"onDragstart"},onPitch:{name:"pitch",listener:"onPitch"},onIdle:{name:"idle",listener:"onIdle"}},p={container:{type:[String,HTMLElement],default:function(){return"map-".concat((""+Math.random()).split(".")[1])}},accessToken:{type:String,default:void 0},minZoom:{type:Number,default:0},maxZoom:{type:Number,default:22},mapStyle:{type:[String,Object],required:!0},hash:{type:[Boolean,String],default:!1},interactive:{type:Boolean,default:!0},bearingSnap:{type:Number,default:7},pitchWithRotate:{type:Boolean,default:!0},clickTolerance:{type:Number,default:3},attributionControl:{type:Boolean,default:!0},customAttribution:{type:[String,Array],default:null},logoPosition:{type:String,default:"bottom-left",validator:function(e){return["top-left","top-right","bottom-left","bottom-right"].includes(e)}},failIfMajorPerformanceCaveat:{type:Boolean,default:!1},preserveDrawingBuffer:{type:Boolean,default:!1},refreshExpiredTiles:{type:Boolean,default:!0},maxBounds:{type:Array,default:function(){}},scrollZoom:{type:[Boolean,Object],default:function(){return!0}},boxZoom:{type:Boolean,default:!0},dragRotate:{type:Boolean,default:!0},dragPan:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},doubleClickZoom:{type:Boolean,default:!0},touchZoomRotate:{type:[Boolean,Object],default:function(){return!0}},trackResize:{type:Boolean,default:!0},center:{type:[Object,Array],default:void 0},zoom:{type:Number,default:0},bearing:{type:Number,default:0},pitch:{type:Number,default:0},bounds:{type:[Object,Array],default:void 0},fitBoundsOptions:{type:Object,default:void 0},renderWorldCopies:{type:Boolean,default:!0},RTLTextPluginUrl:{type:String,default:void 0},light:{type:Object,default:void 0},tileBoundaries:{type:Boolean,default:!1},collisionBoxes:{type:Boolean,default:!1},repaint:{type:Boolean,default:!1},transformRequest:{type:Function,default:null},maxTileCacheSize:{type:Number,default:null},localIdeographFontFamily:{type:String,default:null},collectResourceTiming:{type:Boolean,default:!1},fadeDuration:{type:Number,default:300},crossSourceCollisions:{type:Boolean,default:!0}},d=function(e){var t=/^on[^a-z]/,r={};for(var n in e)t.test(n)&&(r[n]=e[n]);return r},h={maxBounds:function(e){this.map.setMaxBounds(e)},minZoom:function(e){this.map.setMinZoom(e)},maxZoom:function(e){this.map.setMaxZoom(e)},mapStyle:function(e){this.map.setStyle(e)},collisionBoxes:function(e){this.map.showCollisionBoxes=e},tileBoundaries:function(e){this.map.showTileBoundaries=e},repaint:function(e){this.map.repaint=e},zoom:function(e){this.map.setZoom(e)},center:function(e){this.map.setCenter(e)},bearing:function(e){this.map.setBearing(e)},pitch:function(e){this.map.setPitch(e)},light:function(e){this.map.setLigh(e)}};function m(e,t,r,n){var o=this;this.initial||(d(this.$attrs)["onUpdate:".concat(e)]?(this.propsIsUpdating[e]?(this._watcher.active=!1,this.$nextTick((function(){o._watcher.active=!0}))):(this._watcher.active=!0,t(r,n)),this.propsIsUpdating[e]=!1):t(r,n))}var f,y={watch:(f={},Object.entries(h).forEach((function(e){f[e[0]]=function(t,r){return m.call(this,e[0],e[1].bind(this),t,r)}})),f)};function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){i.default(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){i.default(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j={events:[{name:"moveend",check:function(e,t){return t.center&&e.isMoving()}},{name:"zoomend",check:function(e,t){return void 0!==t.zoom&&null!==t.zoom&&e.isZooming()}},{name:"rotateend",check:function(e,t){return void 0!==t.bearing&&null!==t.bearing&&e.isRotating()}},{name:"pitchend",check:function(e,t){return void 0!==t.pitch&&null!==t.bearing&&e.isMoving()}}],getter:function(e){return{center:e.getCenter(),zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch()}}},$={events:[{name:"moveend",check:function(e){return e.isMoving()}}],getter:function(e){return{center:e.getCenter()}}},P={events:[{name:"zoomend",check:function(e){return e.isZooming()}}],getter:function(e){return{zoom:e.getZoom()}}},w={events:[{name:"rotateend",check:function(e){return e.isRotating()}}],getter:function(e){return{bearing:e.getBearing()}}},S={setCenter:$,panBy:$,panTo:$,setZoom:P,zoomTo:P,zoomIn:P,zoomOut:P,setBearing:w,rotateTo:w,resetNorth:w,snapToNorth:w,setPitch:{events:[{name:"pitchend",check:function(e){return!0}}],getter:function(e){return{pitch:e.getPitch()}}},fitBounds:{events:[{name:"zoomend",check:function(e){return e.isZooming()}},{name:"moveend",check:function(e){return e.isMoving()}},{name:"rotateend",check:function(e){return e.isRotating()}}],getter:function(e){return{zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch(),center:e.getCenter()}}},fitScreenCoordinates:{events:[{name:"zoomend",check:function(e,t){return e.isZooming()}},{name:"moveend",check:function(e,t){return e.isMoving()}},{name:"rotateend",check:function(e,t){return t.bearing&&e.isRotating()}}],getter:function(e){return{zoom:e.getZoom(),center:e.getCenter(),bearing:e.getBearing(),pitch:e.getPitch()}}},jumpTo:j,easeTo:j,flyTo:j};function _(e){return"".concat(e,"-").concat((""+Math.random()).split(".")[1])}function E(e,t,r,n){return function o(i){i.type===t&&i.eventId===r&&(e.off(t,o),n(i))}}function I(e,t){var r=e[t],n=r.length;return function(){for(var o=[],i={eventId:_(t)},s=S[t].events.map((function(t,r){return{event:t,func:new Promise((function(n,a){o[r]={event:t,func:E(e,t.name,i.eventId,n)},e.on(t.name,o[r].func)}))}})),c=[],u=0;u<n;u++)u===n-1?c.push(O(O({},i),(u<0||arguments.length<=u?void 0:arguments[u])||{})):c.push((u<0||arguments.length<=u?void 0:arguments[u])||null);var l=[],p=(arguments.length<=0?void 0:arguments[0])||{};try{r.apply(e,c),"fitBounds"===t&&(p={}),"fitScreenCoordinates"===t&&((p={bearing:null}).bearing=null,"number"==typeof(arguments.length<=2?void 0:arguments[2])&&(p.bearing=arguments.length<=2?void 0:arguments[2]),(arguments.length<=3?void 0:arguments[3])&&"object"===a.default(arguments.length<=3?void 0:arguments[3])&&(p=O(O({},p),arguments.length<=3?void 0:arguments[3]))),l=s.map((function(t){var r=t.event,n=t.func;return r.check(e,p)?n:(e.off(r.name,n),Promise.resolve())}))}catch(t){throw o.forEach((function(t){var r=t.event,n=t.func;e.off(r.name,n)})),t}return Promise.all(l).then((function(){return S[t].getter(e)}))}}function L(e){var t=Object.keys(S),r={};return t.forEach((function(n){-1!==t.indexOf(n)&&(r[n]=I(e,n))})),r}function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){i.default(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var D={name:"GlMap",mixins:[y,{created:function(){this.actions={}},methods:{$_registerAsyncActions:function(e){this.actions=k(k({},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t?I(e,t):L(e)}(e)),{},{stop:function(){var e=this;this.map.stop();var t={pitch:this.map.getPitch(),zoom:this.map.getZoom(),bearing:this.map.getBearing(),center:this.map.getCenter()};return Object.entries(t).forEach((function(t){e.$_updateSyncedPropsFabric(t[0],t[1])()})),Promise.resolve(t)}})}}},{methods:{$_updateSyncedPropsFabric:function(e,t){var r=this;return function(){r.propsIsUpdating[e]=!0;var n="function"==typeof t?t():t;return r.$emit("update:".concat(e),n)}},$_bindPropsUpdateEvents:function(){var e=this,t=[{events:["moveend"],prop:"center",getter:this.map.getCenter.bind(this.map)},{events:["zoomend"],prop:"zoom",getter:this.map.getZoom.bind(this.map)},{events:["rotate"],prop:"bearing",getter:this.map.getBearing.bind(this.map)},{events:["pitch"],prop:"pitch",getter:this.map.getPitch.bind(this.map)},{events:["moveend","zoomend","rotate","pitch"],prop:"bounds",getter:function(){var t=e.map.getBounds();return e.$props.bounds instanceof Array&&(t=t.toArray()),t}}],r=d(this.$attrs);t.forEach((function(t){var n=t.events,o=t.prop,i=t.getter;n.forEach((function(t){r["onUpdate:".concat(o)]&&e.map.on(t,e.$_updateSyncedPropsFabric(o,i))}))}))},$_loadMap:function(){var e=this;return this.mapboxPromise.then((function(t){return e.mapbox=t.default?t.default:t,new Promise((function(t){e.accessToken&&(e.mapbox.accessToken=e.accessToken);var r=new e.mapbox.Map(g(g({},e._props),{},{container:e.$refs.container,style:e.mapStyle}));r.on("load",(function(){return t(r)}))}))}))},$_RTLTextPluginError:function(e){this.$emit("rtl-plugin-error",{map:this.map,error:e})},$_bindMapEvents:function(e){var t=this,r=e.map((function(e){return e.name})),n=d(this.$attrs);Object.keys(n).forEach((function(e){var n=e.substring(2).toLowerCase();r.includes(n)&&t.map.on(n,t.$_emitMapEvent)}))},$_unbindEvents:function(e){var t=this;e.forEach((function(e){t.map.off(e,t.$_emitMapEvent)}))}}},u],props:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){i.default(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({mapboxGl:{type:Object,default:null}},p),provide:function(){var e=this;return{mapbox:r.computed((function(){return e.mapbox})),map:r.computed((function(){return e.map})),actions:r.computed((function(){return e.actions}))}},data:function(){return{initial:!0,initialized:!1}},computed:{loaded:function(){return!!this.map&&this.map.loaded()},version:function(){return this.map?this.map.version:null},isStyleLoaded:function(){return!!this.map&&this.map.isStyleLoaded()},areTilesLoaded:function(){return!!this.map&&this.map.areTilesLoaded()},isMoving:function(){return!!this.map&&this.map.isMoving()},canvas:function(){return this.map?this.map.getCanvas():null},canvasContainer:function(){return this.map?this.map.getCanvasContainer():null},images:function(){return this.map?this.map.listImages():null}},created:function(){this.map=null,this.propsIsUpdating={},this.$_containerVNode=null,this.mapboxPromise=this.mapboxGl?Promise.resolve(this.mapboxGl):import("mapbox-gl")},mounted:function(){var e=this;this.$_loadMap().then((function(t){e.map=t,void 0!==e.RTLTextPluginUrl&&"loaded"!==e.mapbox.getRTLTextPluginStatus()&&e.mapbox.setRTLTextPlugin(e.RTLTextPluginUrl,e.$_RTLTextPluginError);var r=Object.values(l);e.$_bindMapEvents(r),e.$_registerAsyncActions(t),e.$_bindPropsUpdateEvents(),e.initial=!1,e.initialized=!0,e.$emit("load",{map:t,component:e})}))},beforeDestroy:function(){var e=this;this.$nextTick((function(){e.map&&e.map.remove()}))},render:function(){return this.$$_containerVNode||(this.$_containerVNode=r.h("div",{id:this.container,ref:"container"})),r.h("div",{class:"mgl-map-wrapper"},[this.$_containerVNode,this.initialized?this.$slots.default():null])}};function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){i.default(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var T={methods:{$_emitSelfEvent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.$_emitMapEvent(e,B({control:this.control},t))},$_bindSelfEvents:function(e,t){var r=this,n=d(this.$attrs);Object.keys(n).forEach((function(n){var o=n.substring(2).toLowerCase();e.includes(o)&&t.on(o,r.$_emitSelfEvent)}))},$_unbindSelfEvents:function(e,t){var r=this;0!==e.length&&t&&e.forEach((function(e){t.off(e,r.$_emitSelfEvent)}))}}},z={mixins:[u,T],inject:["mapbox","map","actions"],props:{position:{type:String,default:"top-right"}},beforeDestroy:function(){this.map&&this.control&&this.map.value.removeControl(this.control)},methods:{$_addControl:function(){try{this.map.value.addControl(this.control,this.position)}catch(e){return void this.$_emitEvent("error",{error:e})}this.$_emitEvent("added",{control:this.control})}},render:function(){}},R={name:"NavigationControl",mixins:[z],props:{showCompass:{type:Boolean,default:!0},showZoom:{type:Boolean,default:!0}},created:function(){this.control=new this.mapbox.value.NavigationControl(this.$props),this.$_addControl()}},Z={trackuserlocationstart:"trackuserlocationstart",trackuserlocationend:"trackuserlocationend",geolocate:"geolocate",error:"error"},F={name:"GeolocateControl",mixins:[u,T,z],props:{positionOptions:{type:Object,default:function(){return{enableHighAccuracy:!1,timeout:6e3}}},fitBoundsOptions:{type:Object,default:function(){return{maxZoom:15}}},trackUserLocation:{type:Boolean,default:!1},showUserLocation:{type:Boolean,default:!0}},created:function(){var e=this.mapbox.value.GeolocateControl;this.control=new e(this.$props),this.$_addControl(),this.$_bindSelfEvents(Object.keys(Z),this.control)},methods:{trigger:function(){if(this.control)return this.control.trigger()}}},A={name:"FullscreenControl",mixins:[z],props:{container:{type:HTMLElement,default:void 0}},created:function(){this.control=new this.mapbox.value.FullscreenControl(this.$props),this.$_addControl()}},N={name:"AttributionControl",mixins:[z],props:{compact:{type:Boolean,default:!0},customAttribution:{type:[String,Array],deafault:void 0}},created:function(){this.control=new this.mapbox.value.AttributionControl(this.$props),this.$_addControl()}},U={name:"ScaleControl",mixins:[z],props:{maxWidth:{type:Number,default:150},unit:{type:String,default:"metric",validator:function(e){return["imperial","metric","nautical"].includes(e)}}},watch:{unit:function(e,t){this.control&&e!==t&&this.control.setUnit(e)}},created:function(){this.control=new this.mapbox.value.ScaleControl(this.$props),this.$_addControl()}};function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var G={drag:"drag",dragstart:"dragstart",dragend:"dragend"},V={click:"click",mouseenter:"mouseenter",mouseleave:"mouseleave"},W={name:"MapMarker",mixins:[u,T],inject:["mapbox","map"],provide:function(){var e=this;return{get marker(){return e.marker}}},props:{offset:{type:[Object,Array],default:function(){return[0,0]}},coordinates:{type:Array,required:!0},color:{type:String},anchor:{type:String,default:"center"},draggable:{type:Boolean,default:!1}},data:function(){return{initial:!0,marker:void 0}},watch:{coordinates:function(e){this.initial||this.marker.setLngLat(e)},draggable:function(e){this.initial||this.marker.setDraggable(e)}},mounted:function(){var e=this,t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach((function(t){i.default(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.$props);this.$slots.marker&&(t.element=this.$slots.marker[0].elm),this.marker=new this.mapbox.value.Marker(t),d(this.$attrs)["onUpdate:coordinates"]&&this.marker.on("dragend",(function(t){var r;r=e.coordinates instanceof Array?[t.target._lngLat.lng,t.target._lngLat.lat]:t.target._lngLat,e.$emit("update:coordinates",r)}));var r=Object.keys(G);this.$_bindSelfEvents(r,this.marker),this.initial=!1,this.$_addMarker()},beforeDestroy:function(){void 0!==this.map&&void 0!==this.marker&&this.marker.remove()},methods:{$_addMarker:function(){this.marker.setLngLat(this.coordinates).addTo(this.map.value),this.$_bindMarkerDOMEvents(),this.$_emitEvent("added",{marker:this.marker})},$_emitSelfEvent:function(e){this.$_emitMapEvent(e,{marker:this.marker})},$_bindMarkerDOMEvents:function(){var e=this,t=d(this.$attrs);Object.keys(t).forEach((function(t){var r=t.substring(2).toLowerCase();Object.values(V).includes(r)&&e.marker._element.addEventListener(r,(function(t){e.$_emitSelfEvent(t)}))}))},remove:function(){this.marker.remove(),this.$_emitEvent("removed")},togglePopup:function(){return this.marker.togglePopup()}},render:function(){return r.h("div",{style:{display:"none"}},[this.$slots.marker(),this.marker?this.$slots.default():null])}},H={open:"open",close:"close"},J={name:"Popup",mixins:[u,T],inject:{mapbox:{default:null},map:{default:null},marker:{default:null}},props:{closeButton:{type:Boolean,default:!0},closeOnClick:{type:Boolean,default:!0},anchor:{validator:function(e){return"string"==typeof e&&["top","bottom","left","right","top-left","top-right","bottom-left","bottom-right"].includes(e)},default:void 0},offset:{type:[Number,Object,Array],default:function(){return[0,0]}},coordinates:{type:Array},onlyText:{type:Boolean,default:!1},showed:{type:Boolean,default:!1}},data:function(){return{initial:!0,popup:void 0}},computed:{open:{get:function(){return void 0!==this.popup&&this.popup.isOpen()},set:function(e){this.map&&this.popup&&(e?this.popup.addTo(this.map.value):this.popup.remove())}}},watch:{coordinates:function(e){this.initial||this.popup.setLngLat(e)},showed:function(e,t){e!==t&&(this.open=e,this.marker&&this.marker.togglePopup())}},created:function(){this.popup=new this.mapbox.value.Popup(this.$props)},mounted:function(){this.$_addPopup(),this.initial=!1},beforeDestroy:function(){this.map&&(this.popup.remove(),this.$_emitEvent("removed"))},methods:{$_addPopup:function(){if(this.popup=new this.mapbox.value.Popup(this.$props),void 0!==this.coordinates&&this.popup.setLngLat(this.coordinates),void 0!==this.$slots.default)if(this.onlyText)if(3===this.$slots.default[0].elm.nodeType){var e=document.createElement("span");e.appendChild(this.$slots.default[0].elm),this.popup.setText(e.innerText)}else this.popup.setText(this.$slots.default[0].elm.innerText);else this.popup.setDOMContent(this.$slots.default[0].elm);this.$_bindSelfEvents(Object.keys(H),this.popup),this.$_emitEvent("added",{popup:this.popup}),this.marker&&this.marker.setPopup(this.popup),this.showed&&(this.open=!0,this.marker&&this.marker.togglePopup())},$_emitSelfEvent:function(e){this.$_emitMapEvent(e,{popup:this.popup})},remove:function(){this.popup.remove(),this.$_emitEvent("remove",{popup:this.popup})}},render:function(){return r.h("div",{style:{display:"none"}},[this.$slots.default()])}},K={mousedown:"onMousedown",mouseup:"onMouseup",click:"onClick",dblclick:"onDblclick",mousemove:"onMousemove",mouseenter:"onMouseenter",mouseleave:"onMouseleave",mouseover:"onMouseover",mouseout:"onMouseout",contextmenu:"onContextmenu",touchstart:"onTouchstart",touchend:"onTouchend",touchcancel:"onTouchcancel"};function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){i.default(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Y={layerId:{type:String,required:!0},layer:{type:Object,required:!0},before:{type:String,default:void 0}},ee={clearSource:{type:Boolean,default:!0},replaceSource:{type:Boolean,default:!1},replace:{type:Boolean,default:!1}},te={mixins:[u],props:X(X(X({},{sourceId:{type:String,required:!0},source:{type:[Object,String],default:void 0}}),Y),ee),inject:["mapbox","map"],data:function(){return{initial:!0}},computed:{sourceLoaded:function(){return!!this.map&&this.map.value.isSourceLoaded(this.sourceId)},mapLayer:function(){return this.map?this.map.value.getLayer(this.layerId):null},mapSource:function(){return this.map?this.map.value.getSource(this.sourceId):null}},created:function(){this.layer.minzoom&&this.$watch("layer.minzoom",(function(e){this.initial||this.map.value.setLayerZoomRange(this.layerId,e,this.layer.maxzoom)})),this.layer.maxzoom&&this.$watch("layer.maxzoom",(function(e){this.initial||this.map.value.setLayerZoomRange(this.layerId,this.layer.minzoom,e)})),this.layer.paint&&this.$watch("layer.paint",(function(e){if(!this.initial&&e)for(var t=0,r=Object.keys(e);t<r.length;t++){var n=r[t];this.map.value.setPaintProperty(this.layerId,n,e[n])}}),{deep:!0}),this.layer.layout&&this.$watch("layer.layout",(function(e){if(!this.initial&&e)for(var t=0,r=Object.keys(e);t<r.length;t++){var n=r[t];this.map.value.setLayoutProperty(this.layerId,n,e[n])}}),{deep:!0}),this.layer.filter&&this.$watch("layer.filter",(function(e){this.initial||this.map.value.setFilter(this.layerId,e)}),{deep:!0})},beforeDestroy:function(){if(this.map&&this.map.value.loaded()){try{this.map.value.removeLayer(this.layerId)}catch(e){this.$_emitEvent("layer-does-not-exist",{layerId:this.sourceId,error:e})}if(this.clearSource)try{this.map.value.removeSource(this.sourceId)}catch(e){this.$_emitEvent("source-does-not-exist",{sourceId:this.sourceId,error:e})}}},methods:{$_emitLayerMapEvent:function(e){return this.$_emitMapEvent(e,{layerId:this.layerId})},$_bindLayerEvents:function(e){var t=this,r=Object.keys(e),n=d(this.$attrs);Object.keys(n).forEach((function(e){var n=e.substring(2).toLowerCase();r.includes(n)&&t.map.value.on(n,t.layerId,t.$_emitLayerMapEvent)}))},$_unbindEvents:function(e){var t=this;this.map&&e.forEach((function(e){t.map.value.off(e,t.layerId,t.$_emitLayerMapEvent)}))},$_watchSourceLoading:function(e){"source"===e.dataType&&e.sourceId===this.sourceId&&(this.$_emitEvent("layer-source-loading",{sourceId:this.sourceId}),this.map.value.off("dataloading",this.$_watchSourceLoading))},move:function(e){this.map.value.moveLayer(this.layerId,e),this.$_emitEvent("layer-moved",{layerId:this.layerId,beforeId:e})},remove:function(){this.map.value.removeLayer(this.layerId),this.map.value.removeSource(this.sourceId),this.$_emitEvent("layer-removed",{layerId:this.layerId}),this.$destroy()}},render:function(){}};function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){i.default(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach((function(t){i.default(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(r),!0).forEach((function(t){i.default(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ae(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(r),!0).forEach((function(t){i.default(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?le(Object(r),!0).forEach((function(t){i.default(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function he(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?de(Object(r),!0).forEach((function(t){i.default(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var me=u,fe=T,ye=z,ve=te,ge={withEvents:u,withSelfEvents:T,asControl:z,asLayer:te},be=D,Oe=R,je=F,$e=A,Pe=N,we=U,Se={name:"GeojsonLayer",mixins:[te],computed:{getSourceFeatures:function(){var e=this;return function(t){return e.map?e.map.querySourceFeatures(e.sourceId,{filter:t}):null}},getRenderedFeatures:function(){var e=this;return function(t,r){return e.map?e.map.queryRenderedFeatures(t,{layers:[e.layerId],filter:r}):null}},getClusterExpansionZoom:function(){var e=this;return function(t){return new Promise((function(r,n){if(!e.mapSource)return n(new Error("Map source with id ".concat(e.sourceId," not found.")));e.mapSource.getClusterExpansionZoom(t,(function(e,t){return e?n(e):r(t)}))}))}},getClusterChildren:function(){var e=this;return function(t){return new Promise((function(r,n){var o=e.mapSource;if(!o)return n(new Error("Map source with id ".concat(e.sourceId," not found.")));o.getClusterChildren(t,(function(e,t){return e?n(e):r(t)}))}))}},getClusterLeaves:function(){var e=this;return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return new Promise((function(t,n){if(!e.mapSource)return n(new Error("Map source with id ".concat(e.sourceId," not found.")));var o;(o=e.mapSource).getClusterLeaves.apply(o,r.concat([function(e,r){return e?n(e):t(r)}]))}))}}},created:function(){this.source&&this.$watch("source.data",(function(e){this.initial||this.mapSource.setData(e)}),{deep:!0}),this.$_deferredMount()},methods:{$_deferredMount:function(){if(this.map.on("dataloading",this.$_watchSourceLoading),this.source){var e=ne({type:"geojson"},this.source);try{this.map.addSource(this.sourceId,e)}catch(t){this.replaceSource&&(this.map.removeSource(this.sourceId),this.map.addSource(this.sourceId,e))}}this.$_addLayer(),this.$_bindLayerEvents(K),this.map.off("dataloading",this.$_watchSourceLoading),this.initial=!1},$_addLayer:function(){var e=this.map.getLayer(this.layerId);if(e){if(!this.replace)return this.$_emitEvent("layer-exists",{layerId:this.layerId}),e;this.map.removeLayer(this.layerId)}var t=ne({id:this.layerId,source:this.sourceId},this.layer);this.map.addLayer(t,this.before),this.$_emitEvent("added",{layerId:this.layerId})},setFeatureState:function(e,t){if(this.map){var r={id:e,source:this.source};return this.map.setFeatureState(r,t)}},getFeatureState:function(e){if(this.map){var t={id:e,source:this.source};return this.map.getFeatureState(t)}},removeFeatureState:function(e,t,r){if(this.map){var n={id:e,source:this.source,sourceLayer:t};return this.map.removeFeatureState(n,r)}}}},_e={name:"ImageLayer",mixins:[te],created:function(){this.source&&(this.source.coordinates&&this.$watch("source.coordinates",(function(e){this.initial||e&&this.mapSource.setCoordinates(e)}),{deep:!0}),this.source.url&&this.$watch("source.url",(function(e){this.initial||e&&this.mapSource.updateImage({url:e,coordinates:this.source.coordinates})}),{deep:!0})),this.$_deferredMount()},methods:{$_deferredMount:function(){var e=ie({type:"image"},this.source);this.map.on("dataloading",this.$_watchSourceLoading);try{this.map.addSource(this.sourceId,e)}catch(t){this.replaceSource&&(this.map.removeSource(this.sourceId),this.map.addSource(this.sourceId,e))}this.$_addLayer(),this.$_bindLayerEvents(K),this.initial=!1},$_addLayer:function(){var e=this.map.getLayer(this.layerId);if(e){if(!this.replace)return this.$_emitEvent("layer-exists",{layerId:this.layerId}),e;this.map.removeLayer(this.layerId)}var t=ie({id:this.layerId,source:this.sourceId,type:"raster"},this.layer);this.map.addLayer(t,this.before),this.$_emitEvent("added",{layerId:this.layerId})}}},Ee={name:"CanvasLayer",mixins:[te],inject:["mapbox","map"],props:{source:{type:Object,required:!0},layer:{type:Object,default:null}},computed:{canvasElement:function(){return this.mapSource?this.mapSource.getCanvas():null}},watch:{coordinates:function(e){this.initial||this.mapSource.setCoordinates(e)}},created:function(){this.$_deferredMount()},methods:{$_deferredMount:function(){var e=se({type:"canvas"},this.source);this.map.on("dataloading",this.$_watchSourceLoading);try{this.map.addSource(this.sourceId,e)}catch(t){this.replaceSource&&(this.map.removeSource(this.sourceId),this.map.addSource(this.sourceId,e))}this.$_addLayer(),this.$_bindLayerEvents(K),this.initial=!1},$_addLayer:function(){var e=this.map.getLayer(this.layerId);if(e){if(!this.replace)return this.$_emitEvent("layer-exists",{layerId:this.layerId}),e;this.map.removeLayer(this.layerId)}var t=se({id:this.layerId,source:this.sourceId,type:"raster"},this.layer);this.map.addLayer(t,this.before),this.$_emitEvent("added",{layerId:this.layerId,canvas:this.canvasElement})}}},Ie={name:"VideoLayer",mixins:[te],computed:{video:function(){return this.map.getSource(this.sourceId).getVideo()}},created:function(){this.source&&this.source.coordinates&&this.$watch("source.coordinates",(function(e){this.initial||this.mapSource.setCoordinates(e)})),this.$_deferredMount()},methods:{$_deferredMount:function(){var e=ue({type:"video"},this.source);this.map.on("dataloading",this.$_watchSourceLoading);try{this.map.addSource(this.sourceId,e)}catch(t){this.replaceSource&&(this.map.removeSource(this.sourceId),this.map.addSource(this.sourceId,e))}this.$_addLayer(),this.$_bindLayerEvents(K),this.initial=!1},$_addLayer:function(){var e=this.map.getLayer(this.layerId);if(e){if(!this.replace)return this.$_emitEvent("layer-exists",{layerId:this.layerId}),e;this.map.removeLayer(this.layerId)}var t=ue({id:this.layerId,source:this.sourceId,type:"background"},this.layer);this.map.addLayer(t,this.before),this.$_emitEvent("added",{layerId:this.layerId})}}},Le={name:"VectorLayer",mixins:[te],computed:{getSourceFeatures:function(){var e=this;return function(t){return e.map?e.map.value.querySourceFeatures(e.sourceId,{sourceLayer:e.layer["source-layer"],filter:t}):null}},getRenderedFeatures:function(){var e=this;return function(t,r){return e.map?e.map.value.queryRenderedFeatures(t,{layers:[e.layerId],filter:r}):null}}},watch:{filter:function(e){this.initial||this.map.value.setFilter(this.layerId,e)}},created:function(){this.$_deferredMount()},methods:{$_deferredMount:function(){var e=pe({type:"vector"},this.source);this.map.value.on("dataloading",this.$_watchSourceLoading);try{this.map.value.addSource(this.sourceId,e)}catch(t){this.replaceSource&&(this.map.value.removeSource(this.sourceId),this.map.value.addSource(this.sourceId,e))}this.$_addLayer(),this.$_bindLayerEvents(K),this.map.value.off("dataloading",this.$_watchSourceLoading),this.initial=!1},$_addLayer:function(){var e=this.map.value.getLayer(this.layerId);if(e){if(!this.replace)return this.$_emitEvent("layer-exists",{layerId:this.layerId}),e;this.map.value.removeLayer(this.layerId)}var t=pe({id:this.layerId,source:this.sourceId},this.layer);this.map.value.addLayer(t,this.before),this.$_emitEvent("added",{layerId:this.layerId})},setFeatureState:function(e,t){if(this.map){var r={id:e,source:this.sourceId,"source-layer":this.layer["source-layer"]};return this.map.value.setFeatureState(r,t)}},getFeatureState:function(e){if(this.map){var t={id:e,source:this.source,"source-layer":this.layer["source-layer"]};return this.map.value.getFeatureState(t)}}}},xe={name:"RasterLayer",mixins:[te],created:function(){this.$_deferredMount()},methods:{$_deferredMount:function(){var e=he({type:"raster"},this.source);this.map.on("dataloading",this.$_watchSourceLoading);try{this.map.addSource(this.sourceId,e)}catch(t){this.replaceSource&&(this.map.removeSource(this.sourceId),this.map.addSource(this.sourceId,e))}this.$_addLayer(),this.$_bindLayerEvents(K),this.map.off("dataloading",this.$_watchSourceLoading),this.initial=!1},$_addLayer:function(){var e=this.map.getLayer(this.layerId);if(e){if(!this.replace)return this.$_emitEvent("layer-exists",{layerId:this.layerId}),e;this.map.removeLayer(this.layerId)}var t=he({id:this.layerId,type:"raster",source:this.sourceId},this.layer);this.map.addLayer(t,this.before),this.$_emitEvent("added",{layerId:this.layerId})}}},ke=W,Me=J;e.$helpers=ge,e.MglAttributionControl=Pe,e.MglCanvasLayer=Ee,e.MglFullscreenControl=$e,e.MglGeojsonLayer=Se,e.MglGeolocateControl=je,e.MglImageLayer=_e,e.MglMap=be,e.MglMarker=ke,e.MglNavigationControl=Oe,e.MglPopup=Me,e.MglRasterLayer=xe,e.MglScaleControl=we,e.MglVectorLayer=Le,e.MglVideoLayer=Ie,e.asControl=ye,e.asLayer=ve,e.withEvents=me,e.withSelfEvents=fe,Object.defineProperty(e,"__esModule",{value:!0})}));
